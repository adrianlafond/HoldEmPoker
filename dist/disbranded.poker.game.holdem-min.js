!function(a,b){"function"==typeof define&&define.amd?define(["disbranded.poker"],b):"object"==typeof exports?module.exports=b(require("disbranded.poker")):(a.POKER.games=a.POKER.games||{},a.POKER.games.Holdem=b(a.POKER))}(this,function(a){"use strict";function b(b){this.options=a.util.extend({},d,b||{}),this.active=!1,this.deck=new a.Deck,this.table=new a.Table({seats:this.options.seats}),this.rounds={preflop:null,flop:null,turn:null,river:null}}var c=a.util.each,d={action:null,seats:5,limit:a.FIXED_LIMIT,bets:[10,20]};return b.prototype={deal:function(){var b=this.validate();return 200===b.status&&(this.active=!0,this.deck.shuffle(),this.addPlayersToTable(),this.broadcast("button",{player:this.table.button().id}),this.rounds.preflop=new a.Round,this.smallBlind(),this.bigBlind(),this.dealHoleCard(),this.dealHoleCard(),console.log(this.summary())),b},smallBlind:function(){var b=this.table.smallBlind(),c=Math.min(b.chips,this.options.bets[0]/2),d=new a.Bet(b.id,c,b.chips===c),e={player:b.id,chips:c};b.chips-=c,this.rounds.preflop.bet(d),this.broadcast("smallblind",e)},bigBlind:function(){var b=this.table.bigBlind(),c=Math.min(b.chips,this.options.bets[0]),d=new a.Bet(b.id,c,b.chips===c),e={player:b.id,chips:c};b.chips-=c,this.rounds.preflop.bet(d),this.broadcast("bigblind",e)},broadcast:function(a,b){this.options.action({target:this,type:a,data:b})},addPlayersToTable:function(){c(this.options.players,function(b){this.table.add({seat:b.seated,player:new a.Player({id:b.id,chips:b.chips})})},this)},dealHoleCard:function(){c(this.options.players,function(b){var c=this.deck.deal();c.face=a.FACE_DOWN,this.broadcast("deal:hole",{to:b.id,card:c})},this)},summary:function(){var a=[];return this.table.seats.forEach(function(b,c){a[c]=b?{id:b.id,chips:b.chips,folded:b.folded}:null}),{seats:a,button:this.table.button().id,smallBlind:this.table.smallBlind().id,bigBlind:this.table.bigBlind().id}},reset:function(){},validate:function(){var a={status:200,message:null};return this.active&&(a.status=500,a.message="A hand is already in progress."),this.options.players.length<2&&(a.status=501,a.message="There must be at least two players."),"function"!=typeof this.options.action&&(a.status=502,a.message='An "action" callback function was not defined.'),a}},b});